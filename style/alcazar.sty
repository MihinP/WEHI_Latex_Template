% 
%            ,,                                        
%          `7MM            _.o9                                
%            MM                                             
%  ,6"Yb.    MM  ,p6"bo   ,6"Yb.  M"""MMV  ,6"Yb.  `7Mb,od8 
% 8)   MM    MM 6M'  OO  8)   MM  '  AMV  8)   MM    MM' "' 
%  ,pm9MM    MM 8M        ,pm9MM    AMV    ,pm9MM    MM     
% 8M   MM    MM YM.    , 8M   MM   AMV  , 8M   MM    MM     
% `Moo9^Yo..JMML.YMbmd'  `Moo9^Yo.AMMmmmM `Moo9^Yo..JMML.   
% 
% 
% Free and Open-Source template for academic works
% https://github.com/dpmj/alcazar


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Import the packages and definitions 

\usepackage{style/pkgs}
\usepackage{style/colors}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PDF PARAMETERS

% \pdfminorversion=6
% \pdfobjcompresslevel=3
% \pdfcompresslevel=9

\pdfminorversion=7
\pdfinclusioncopyfonts=1
\pdfgentounicode=1

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TEXT STYLE

\setlength{\parindent}{5mm}  % Indentation
\setlength{\parskip}{1mm}  % Paragraph skip

% \setlength{\parsep}{2mm}
% \setlength{\headsep}{4mm}
% \setlength{\topskip}{0mm}
% \setlength{\topmargin}{0mm}
% \setlength{\topsep}{4mm}
% \setlength{\partopsep}{0mm}

% Default spacing between lines
\renewcommand{\baselinestretch}{1.0}  

% Commands to have small monospace text
\NewCommandCopy{\svtt}{\texttt}
\renewcommand\texttt[1]{\svtt{\small#1}}

% No skip between items in a list to save space 
% Enumitem config
\setenumerate{itemsep=0mm}
\setitemize{itemsep=0mm}
\setdescription{itemsep=0mm}

% Uncomment for no hypenation
% \tolerance=1
% \emergencystretch=\maxdimen
% \hyphenpenalty=10000
% \hbadness=10000


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% STYLE OF TITLES

% Chapter

\titleformat{\chapter}[display]
{}
{\large \scshape \chaptername \enspace \thechapter}
{0mm}
{\LARGE \bfseries}
[]

\titlespacing{\chapter}{0mm}{-5mm}{5mm}
\titlespacing{\section}{0mm}{3mm}{1mm}
\titlespacing{\subsection}{0mm}{3mm}{1mm}
\titlespacing{\subsubsection}{0mm}{3mm}{1mm}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TABLE OF CONTENTS 

\setcounter{tocdepth}{4}
\setcounter{secnumdepth}{4}

% Change TOC indentation
% \makeatletter
%     \renewcommand*\l@section{\@dottedtocline{1}{0.75em}{2em}}
%     \renewcommand*\l@subsection{\@dottedtocline{1}{1.5em}{2.5em}}
%     \renewcommand*\l@subsubsection{\@dottedtocline{1}{2.25em}{3.25em}}
%     \renewcommand*\l@paragraph{\@dottedtocline{1}{3em}{3.75em}}
%     % \renewcommand*\l@subparagraph{\@dottedtocline{1}{3.75em}{4em}}
% \makeatother

% Column separation - multicol
\setlength{\columnsep}{8mm}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% HYPERREF SETUP

\hypersetup{%
    pdfborder = {0 0 0},
    unicode = true,  % allows to use characters of non-Latin based languages
    bookmarksnumbered = true,
    pdfstartview = {FitH},
        %– FitH : Fit whole width of page
        %– FitV : Fit whole height of page
        %– FitB : Fit whole ”Bounding Box” page
        %– FitBH: Fit whole width of ”Bounding Box” of page
        %– FitBV: Fit whole height of ”Bounding Box” of page
    pdfpagemode = UseOutlines,
    pdftitle = {\thesisTitle},  % title
    pdfauthor = {\thesisAuthor, \thesisTutor},  % authors
    pdfsubject = {\thesisType - \thesisTitle},  % subject of the document
    pdfkeywords = {\thesisKeywords},  % list of keywords
    pdfinfo={%
        Title={\thesisTitle},
        Author={\thesisAuthor}
    },
    colorlinks = true,  % false: boxed links; true: colored links
    linkcolor = url-color,  % color of internal links (blue)
    citecolor = cite-color,  % color of links to bibliography (green)
    filecolor = file-color,  % color of file links (black)
    urlcolor = url-color,  % color of external links (green)
}

\title{\thesisTitle}
\author{\thesisAuthor}

% change color of glossary cites to black
\renewcommand*{\glstextformat}[1]{\textcolor{black}{#1}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CODE LISTINGS - MINTED

\usemintedstyle{colorful}
% Good options (for light themes): default, sas, solarized-light, pastie, colorful, bw
% solarized-light has not the best readability
% pastie and colorful may be buggy when using linebreaks and escapeinsides

% To get a list of all available stylesheets, see the online demo at the Pygments
% website or execute the following command on the command line:
% $ pygmentize -L styles


\setminted{bgcolor=listing-background,
           fontsize=\scriptsize,
           escapeinside=¢¢,
           tabsize=4,
           linenos,
           breaklines}
           
\newenvironment{code}{\captionsetup{type=listing}}{}
\SetupFloatingEnvironment{listing}{name=Listing}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FIGURES AND CAPTIONS

\renewcommand{\subfigureautorefname}{\figureautorefname}  % fix autoref for subfloats

% Spacing

\setlength{\abovedisplayskip}{2mm}  % space above captions
\setlength{\belowdisplayskip}{2mm}  % space below captions
\setlength{\abovedisplayshortskip}{0mm}  % space above captions
\setlength{\belowdisplayshortskip}{0mm}  % space below captions
\setlength{\intextsep}{2mm}  % space on top and bottom of an in-text float
\setlength{\floatsep}{2mm}  % space between adjacent floats on the top or
\setlength{\textfloatsep}{2mm}  % space between text and floats at the top or bottom

% Number of figures

% \setcounter{topnumber}{3}  % Max. number of figs. on top
% \setcounter{bottomnumber}{3}  % Max. number of figs. on bottom
% \setcounter{totalnumber}{10}  % Max. number of figs. per page

% \renewcommand{\topfraction}{1}  % Ratio of page filled with figures
% \renewcommand{\bottomfraction}{1}  % Ratio of page filled with figures
% \renewcommand{\textfraction}{0}  % Ratio of page filled with text
% \renewcommand{\floatpagefraction}{1}  % Ratio of page filled with floats


% New 'M' style for tables that centers text vertically and horizontally. 
\newcolumntype{M}[1]{>{\centering\arraybackslash}m{#1}}
% New 'R' style for tables that centers text vertically and to the right
\newcolumntype{R}[1]{>{\raggedleft\arraybackslash}m{#1}}
% New 'L' style for tables that centers text vertically and to the left
\newcolumntype{L}[1]{>{\raggedright\arraybackslash}m{#1}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% ICONS

% Command to vertically centre adjacent content
\newcommand{\vcenteredhbox}[1]
{%
    \noindent\setbox0=\hbox{#1}\parbox{\wd0}{\box0}%
}

% 1: FontAwesome icon command, e.g.: "\faLinkedIn"
% 2: box size (in pt), e.g.: "12" 
% 3: color, e.g.: "blue"
\newcommand{\icon}[3]
{%
    \vcenteredhbox{%
        \colorbox{#3}{%
            \makebox(#2, #2){%
                \textcolor{white}{\noindent #1}%
            }%
        }%
    }%
}


%% BIBLIOGRAPHY

% Bibliography redefinition so its on double column

% \patchcmd{\thebibliography}
%     {\list}
%     {\begin{multicols}{2}\small\list}
%     {}
%     {}
% \appto{\endthebibliography}{\end{multicols}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CHAPTER NUMBER IN THE SIDE

% Definition of the box with number inside with tikz

\newcommand{\chapterNumber}[1]
{%
    \begin{tikzpicture}%
        [blob/.style={minimum width=10mm, minimum height=15mm, align=center}]
        \node[blob, fill=gray07, text=white] at (0,0) { \sffamily \bfseries \Huge #1};
    \end{tikzpicture}
}


% For chapters

\newcommand{\rightChapterNumber}
{%
    \begin{picture}(0,0)
        \put(16mm, -25.5mm - 15mm * \value{chapter} + 15mm) {\chapterNumber{\arabic{chapter}}}
    \end{picture}
}
\newcommand{\leftChapterNumber}
{%
    \begin{picture}(0,0)
        \put(-25mm, -25.5mm - 15mm * \value{chapter} + 15mm) {\chapterNumber{\arabic{chapter}}}
    \end{picture}
}


% For appendices

\newcommand{\rightAppendixNumber}
{%
    \begin{picture}(0,0)
        \put(16mm, -25.5mm - 15mm * \value{chapter} + 15mm) {\chapterNumber{\Alph{chapter}}}
    \end{picture}
}
\newcommand{\leftAppendixNumber}
{%
    \begin{picture}(0,0)
        \put(-25mm, -25.5mm - 15mm * \value{chapter} + 15mm) {\chapterNumber{\Alph{chapter}}}
    \end{picture}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PAGE STYLE AND GEOMETRY

\geometry{
    a4paper,
    top     = 2.5cm,
    bottom  = 2.5cm,
    inner   = 3.5cm,
    outer   = 2.5cm
} 

% Style of normal pages

% \fancyhead{}

% \fancyhfoffset[RO,LE]{0cm}
    
% \fancyhead[LE]{\small{\thepage}}
% \fancyhead[RE]{\small{\nouppercase{\leftmark}}} 
% \fancyhead[C]{}
% \fancyhead[LO]{\small{\nouppercase{\rightmark}}}
% \fancyhead[RO]{\small{\thepage}}

% \fancyfoot[LE]{\small{\thepage}}
% \fancyfoot[RE]{\small{\thesisTitleShort}}
% \fancyhead[C]{}
% \fancyfoot[LO]{\small{\thesisAuthor}}
% \fancyfoot[RO]{\small{\thepage}}

% \renewcommand{\headrulewidth}{0.2mm}
% \renewcommand{\footrulewidth}{0.2mm}

\setlength{\headheight}{13.6pt}

% \pagestyle{fancy}



% Chapters

\fancypagestyle{chapters}
{
    \fancyhfoffset[RO,LE]{0cm}
    
    \fancyhead[LE]{\leftChapterNumber \small{\thepage}}
    \fancyhead[RE]{\small{\nouppercase{\leftmark}}} 
    \fancyhead[C]{}
    \fancyhead[LO]{\small{\nouppercase{\rightmark}}}
    \fancyhead[RO]{\small{\thepage} \rightChapterNumber}
    
    \fancyfoot[LE]{\small{\thepage}}
    \fancyfoot[RE]{\small{\thesisTitleShort}}
    \fancyhead[C]{}
    \fancyfoot[LO]{\small{\thesisAuthor}}
    \fancyfoot[RO]{\small{\thepage}}
    
    \renewcommand{\headrulewidth}{0.1mm}
    \renewcommand{\footrulewidth}{0.1mm}
}

% Addendum

\fancypagestyle{addenda}
{
    \fancyhfoffset[RO,LE]{0cm}
    
    \fancyhead[LE]{\leftAppendixNumber \small{\thepage}}
    \fancyhead[RE]{\small{\nouppercase{\leftmark}}} 
    \fancyhead[C]{}
    \fancyhead[LO]{\small{\nouppercase{\rightmark}}}
    \fancyhead[RO]{\small{\thepage} \rightAppendixNumber}
    
    \fancyfoot[LE]{\small{\thepage}}
    \fancyfoot[RE]{\small{\thesisTitleShort}}
    \fancyhead[C]{}
    \fancyfoot[LO]{\small{\thesisAuthor}}
    \fancyfoot[RO]{\small{\thepage}}
    
    \renewcommand{\headrulewidth}{0.1mm}
    \renewcommand{\footrulewidth}{0.1mm}
}

% Plain
% Refefine so chapter starts with given style
% First page of bibliography, contents, etc. also uses this style

\fancypagestyle{plain}
{
    \fancyhfoffset[RO,LE]{0cm}
    
    \fancyhead[LE]{}
    \fancyhead[RE]{} 
    \fancyhead[C]{}
    \fancyhead[LO]{}
    \fancyhead[RO]{}
    
    \fancyfoot[LE]{\small{\thepage}}
    \fancyfoot[RE]{}
    \fancyhead[C]{}
    \fancyfoot[LO]{}
    \fancyfoot[RO]{\small{\thepage}}
    
    \renewcommand{\headrulewidth}{0.0mm}
    \renewcommand{\footrulewidth}{0.0mm}
}



% Empty

\fancypagestyle{empty}
{
    \fancyhf{}
    \fancyhead{}
    
    \fancyhead[LE]{}
    \fancyhead[RE]{} 
    \fancyhead[C]{}
    \fancyhead[LO]{}
    \fancyhead[RO]{}
    
    \fancyfoot[LE]{}
    \fancyfoot[RE]{}
    \fancyhead[C]{}
    \fancyfoot[LO]{}
    \fancyfoot[RO]{}
    
    \renewcommand{\headrulewidth}{0mm}
    \renewcommand{\footrulewidth}{0mm}
}


% Bibliography

\fancypagestyle{biblio}
{
    \fancyhfoffset[RO,LE]{0cm}
    
    \fancyhead[LE]{\small{\thepage}}
    \fancyhead[RE]{\small{\nouppercase{\leftmark}}} 
    \fancyhead[C]{}
    \fancyhead[LO]{\small{\nouppercase{\rightmark}}}
    \fancyhead[RO]{\small{\thepage}}
    
    \fancyfoot[LE]{\small{\thepage}}
    \fancyfoot[RE]{\small{\thesisTitleShort}}
    \fancyhead[C]{}
    \fancyfoot[LO]{\small{\thesisAuthor}}
    \fancyfoot[RO]{\small{\thepage}}
    
    \renewcommand{\headrulewidth}{0.2mm}
    \renewcommand{\footrulewidth}{0.2mm}
}


% https://texfaq.org/FAQ-reallyblank

\let\origdoublepage\cleardoublepage
\newcommand{\clearemptydoublepage}{%
  \clearpage
  {\pagestyle{plain}\origdoublepage}%
}

\let\cleardoublepage\clearemptydoublepage



